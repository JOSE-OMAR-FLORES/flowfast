spec:
  name: flowfast-saas
  region: nyc
  databases:
    - engine: PG
      name: flowfast-db
      production: true
      version: "16"
  services:
    - name: web
      github:
        branch: main
        deploy_on_push: true
        repo: JOSE-OMAR-FLORES/flowfast
      build_command: |
        composer install --no-dev --optimize-autoloader --no-interaction
        php artisan config:clear
        npm ci --include=dev
        npm run build
        php artisan storage:link
        php artisan migrate --force
      run_command: heroku-php-apache2 public/
      environment_slug: php
      http_port: 8080
      instance_count: 1
      instance_size_slug: basic-xxs
      envs:
        - key: APP_NAME
          value: "FlowFast SaaS"
        - key: APP_ENV
          value: production
        - key: APP_DEBUG
          value: "false"
        - key: LOG_LEVEL
          value: error
        - key: SESSION_DRIVER
          value: database
        - key: QUEUE_CONNECTION
          value: database
        - key: CACHE_STORE
          value: database
